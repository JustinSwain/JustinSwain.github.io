<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Justin Swain - Video Games</title>
  <link rel="stylesheet" href="/style/style.css">
  <link rel="icon" href="/images/spacecat.png">
  <style>
    .steam-profile {
      text-align: center;
      padding: 30px;
      background: rgba(0,0,0,0.3);
      border-radius: 16px;
      max-width: 500px;
      margin: 30px auto;
    }
    .steam-profile img {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      border: 4px solid #00d4ff;
      box-shadow: 0 0 30px rgba(0,212,255,0.4);
    }
    .steam-profile h2 { margin: 20px 0 8px; font-size: 2rem; color: #00d4ff; }
    .steam-profile .status { font-size: 1.3rem; margin: 10px 0; }
    .online { color: #66ff66; }
    .offline { color: #ff6666; }
    .loading { text-align: center; padding: 40px; color: #aaa; font-size: 1.2rem; }
  </style>
</head>
<body>

<div id="container">
  <div id="topBar"></div>
  <div id="headerArea">
    <div id="header">
      <a href="/"><img src="/images/spacecat.png" height="120px"></a>
      <a href="/" style="text-decoration: none;"><strong style="font-size: x-large;">justinswain.dev</strong></a>
    </div>
  </div>

  <div id="flex">
    <main>
      <div class="box">
        <h1>Video Games</h1>
        <p>My Steam profile.</p>

        <div id="steam-loading" class="loading">Connecting to Steam...</div>
        <div id="steam-profile" class="steam-profile" style="display:none"></div>
      </div>
    </main>
    <sideBar id="sideBarPlaceholder"></sideBar>
  </div>
  <footer id="footerPlaceholder"></footer>
</div>

<script>
// ==== CONFIG — CHANGE THESE TWO LINES ONLY ====
const STEAM_KEY = "BCB2BCC753CA6165382166FD6D7BACFB";
const STEAM_ID  = "76561198123456789";  // ← your actual SteamID64
// ===============================================

async function loadSteamProfile() {
  const loading = document.getElementById('steam-loading');
  const profileDiv = document.getElementById('steam-profile');

  // 30-minute cache
  const cache = localStorage.getItem('steamProfileCache');
  if (cache && Date.now() - JSON.parse(cache).ts < 1800000) {
    render(JSON.parse(cache).data);
    loading.style.display = 'none';
    return;
  }

  try {
    const res = await fetch(
      `https://api.steampowered.com/ISteamUser/GetPlayerSummaries/v0002/?key=${STEAM_KEY}&steamids=${STEAM_ID}`
    );
    const json = await res.json();
    const player = json.response.players[0];

    if (!player) throw new Error("No player data");

    // Cache it
    localStorage.setItem('steamProfileCache', JSON.stringify({ data: player, ts: Date.now() }));

    render(player);
    loading.style.display = 'none';

  } catch (e) {
    loading.innerHTML = "Steam is taking a nap... try again in a minute.";
    console.log("Steam error:", e);
  }

  function render(p) {
    const status = p.personastate === 1 ? "Online" : p.personastate === 0 ? "Offline" : "Away/In-Game";
    const statusClass = p.personastate === 1 ? "online" : "offline";

    profileDiv.innerHTML = `
      <img src="${p.avatarmedium}" alt="Steam Avatar">
      <h2>${p.personaname}</h2>
      <div class="status ${statusClass}">${status}</div>
      ${p.realname ? `<p><strong>Real name:</strong> ${p.realname}</p>` : ""}
      <p>Level: ${p.player_level || "??"} - Account created: ${new Date(p.timecreated * 1000).getFullYear()}</p>
      <p><a href="${p.profileurl}" target="_blank">View full Steam profile →</a></p>
    `;
    profileDiv.style.display = 'block';
  }
}

loadSteamProfile();

// Your usual footer/sidebar + prime clock
async function loadComponent(id, path) {
  try { document.getElementById(id).innerHTML = await (await fetch(path)).text(); } catch(e) {}
}
loadComponent("sideBarPlaceholder", "/components/sidebar.html");
loadComponent("footerPlaceholder", "/components/footer.html");

function isPrime(n) { if(n<2)return false; for(let i=2;i*i<=n;i++)if(n%i===0)return false; return true; }
let n = 2;
setInterval(() => { while(!isPrime(n))n++; const el=document.getElementById("prime-number"); if(el)el.textContent=n++; }, 2000);
</script>

</body>
</html>